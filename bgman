#!/bin/bash

# Name:        bgman
# Author:      Petar KatiÄ‡ (bratpeki)
# Type:        dmenu
# Description: Manage background images using feh
#              This script is intended to be used on WM's, since most, if
#              not all modern DE's have their own background image tools.
#              This one was made specifically for dwm.
#              You should make sure "bgman -l" is ran on startup to ensure
#              that your image is applied
# Arguments:
#              -l (Load - Load your saved configuration)

locationOfFile="$HOME/.config/bash-scripts/bgman"

if [ "$1" == "-l" ] || [ "$1" == "-L" ]; then
	feh --bg-$(sed '2q;d' "$locationOfFile") "$(sed '1q;d' "$locationOfFile")"
else
	pictureLocation="/home/peki/Pictures/wg/" # This location is meant to be manually edited
	pictureLocation="$(find $pictureLocation -type f | dmenu -p "Picture: " -i -l 25 -fn "monospace:bold:pixelsize=16")"
	pictureMode="$(printf "center\nfill\nmax\nscale\ntile" | dmenu -p "Mode: " -i -l 25 -fn "monospace:bold:pixelsize=16")"

	if [ -z "$pictureLocation" ] || [ -z "$pictureMode" ]; then
		exit
	fi

	feh --bg-$pictureMode "$pictureLocation"

	if test -f "$locationOfFile"; then
		rm "$locationOfFile"
	fi

	touch "$locationOfFile"
	printf "$pictureLocation\n$pictureMode" > "$locationOfFile"

fi
